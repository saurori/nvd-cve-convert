package types

import (
	"encoding/xml"
)

type NvdXML struct {
	XMLName        xml.Name    `xml:"nvd"`
	Vuln           string      `xml:"xmlns:vuln,attr"`
	Xmlns          string      `xml:"xmlns,attr"`
	CpeLang        string      `xml:"xmlns:cpe-lang,attr"`
	ScapCore       string      `xml:"xmlns:scap-core,attr"`
	Cvss           string      `xml:"xmlns:cvss,attr"`
	Patch          string      `xml:"xmlns:patch,attr"`
	Xsi            string      `xml:"xmlns:xsi,attr"`
	NvdXMLVersion  string      `xml:"nvd_xml_version,attr"`
	PubDate        string      `xml:"pub_date,attr"`
	SchemaLocation string      `xml:"xsi:schemaLocation,attr"`
	Entry          []*NvdEntry `xml:"entry"`
}

type NvdEntry struct {
	Text                    string                       `xml:",chardata"`
	ID                      string                       `xml:"id,attr"`
	VulnerableConfiguration []NvdVulnerableConfiguration `xml:"vuln:vulnerable-configuration"`
	VulnerableSoftwareList  *NvdVulnerableSoftwareList   `xml:"vuln:vulnerable-software-list,omitempty"`
	CveID                   string                       `xml:"vuln:cve-id"`
	PublishedDatetime       string                       `xml:"vuln:published-datetime"`
	LastModifiedDatetime    string                       `xml:"vuln:last-modified-datetime"`
	Cvss                    *NvdCvss                     `xml:"vuln:cvss,omitempty"`
	SecurityProtection      string                       `xml:"security-protection,omitempty"`
	References              []NvdReference               `xml:"vuln:references"`
	Summary                 string                       `xml:"summary"`
}

type NvdVulnerableConfiguration struct {
	Text        string         `xml:",chardata"`
	ID          string         `xml:"id,attr"`
	LogicalTest NvdLogicalTest `xml:"cpe-lang:logical-test"`
}

type NvdLogicalTest struct {
	Text        string           `xml:",chardata"`
	Operator    string           `xml:"operator,attr"`
	Negate      string           `xml:"negate,attr"`
	LogicalTest []NvdLogicalTest `xml:"cpe-lang:logical-test"`
	FactRef     []NvdFactRef     `xml:"cpe-lang:fact-ref"`
}

type NvdFactRef struct {
	Text string `xml:",chardata"`
	Name string `xml:"name,attr"`
}

type NvdVulnerableSoftwareList struct {
	Text    string   `xml:",chardata"`
	Product []string `xml:"vuln:product"`
}

type NvdCvss struct {
	Text        string         `xml:",chardata"`
	BaseMetrics NvdBaseMetrics `xml:"cvss:base_metrics"`
}

type NvdBaseMetrics struct {
	Text                  string  `xml:",chardata"`
	Score                 float64 `xml:"cvss:score"`
	AccessVector          string  `xml:"cvss:access-vector"`
	AccessComplexity      string  `xml:"cvss:access-complexity"`
	Authentication        string  `xml:"cvss:authentication"`
	ConfidentialityImpact string  `xml:"cvss:confidentiality-impact"`
	IntegrityImpact       string  `xml:"cvss:integrity-impact"`
	AvailabilityImpact    string  `xml:"cvss:availability-impact"`
	Source                string  `xml:"cvss:source"`
	GeneratedOnDatetime   string  `xml:"cvss:generated-on-datetime,omitempty"`
}

type NvdReference struct {
	Text          string           `xml:",chardata"`
	Lang          string           `xml:"xml:lang,attr"`
	ReferenceType string           `xml:"reference_type,attr"`
	Source        string           `xml:"vuln:source"`
	Reference     NvdVulnReference `xml:"vuln:reference"`
}

type NvdVulnReference struct {
	Text string `xml:",chardata"`
	Href string `xml:"href,attr"`
	Lang string `xml:"xml:lang,attr"`
}
